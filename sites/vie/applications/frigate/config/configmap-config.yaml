---
apiVersion: v1
kind: ConfigMap
metadata:
  name: frigate-config
data:
  config.yaml: |
    version: 0.16-0

    mqtt:
      enabled: true
      host: emqx.home-assistant-mqtt
      port: 1883
      topic_prefix: frigate
      client_id: frigate
      stats_interval: 60

    detectors:
      onnx-gpu-0:
        type: onnx

    model:
      path: /models/dfine_s_obj2coco.onnx
      labelmap_path: /labelmap/coco-80.txt
      model_type: dfine
      width: 640
      height: 640
      input_tensor: nchw
      input_dtype: float

    database:
      path: /config/frigate.db

    proxy:
      logout_url: /oauth2/sign_out
      header_map:
        user: X-Forwarded-User
        role: X-Forwarded-Groups
      default_role: viewer

    auth:
      enabled: false
      trusted_proxies:
        - 10.0.0.0/8

    tls:
      enabled: false

    audio:
      enabled: false

    logger:
      default: info

    birdseye:
      enabled: true
      quality: 8
      mode: objects

    ffmpeg:
      hwaccel_args: preset-nvidia
      apple_compatibility: true

    detect:
      enabled: true

    objects:
      track:
        - person

    review:
      alerts:
        enabled: true
        labels:
          - person
      detections:
        enabled: true
        labels:
          - person

    motion:
      # must be enabled for object detection to work
      enabled: true

    notifications:
      enabled: false

    record:
      enabled: true
      expire_interval: 60
      sync_recordings: true
      retain:
        days: 0
        mode: all
      preview:
        quality: medium
      alerts:
        pre_capture: 10
        post_capture: 10
        retain:
          days: 14
          mode: motion
      detections:
        pre_capture: 5
        post_capture: 5
        retain:
          days: 14
          mode: motion

    snapshots:
      enabled: true
      clean_copy: true
      timestamp: false
      retain:
        default: 10
        objects:
          person: 14

    semantic_search:
      enabled: false
      model: jinav1
      model_size: small

    face_recognition:
      enabled: true
      unknown_score: 0.8
      detection_threshold: 0.7
      recognition_threshold: 0.9
      model_size: small

    lpr:
      enabled: false

    genai:
      enabled: false

    timestamp_style:
      position: br
      format: '%Y-%m-%d %r'

    ui:
      time_format: 12hour
      strftime_fmt: '%Y-%m-%d %r'

    go2rtc:
      streams: {}
        # camera-placeholder:
        #   - rtsp://{FRIGATE_RSTP_USERNAME}:{FRIGATE_RTSP_PASSWORD}@10.0.10.10:554/cam/realmonitor?channel=1&subtype=2
        #   - "ffmpeg:camera_placeholder#audio=opus"

    cameras: {}
      # camera-placeholder:
      #   enabled: false
      #   ffmpeg:
      #     output_args:
      #       record: preset-record-generic-audio-copy
      #     inputs:
      #       - path: rtsp://127.0.0.1:8554/camera_placeholder
      #         input_args: preset-rtsp-restream
      #         roles:
      #           - audio
      #           - detect
      #           - record
      #   # configure onvif for PTZ control
      #   ui:
      #     dashboard: true

    camera_groups: {}
      # group-placeholder:
      #   icon: LuCar
      #   cameras:
      #     - camera-placeholder
