---
adminPassword: hashed-password
upstreamDns:
  ipv4: "1.1.1.1"
  ipv6: "2606:4700:4700::1111"
exclusions:
  - apps.apple.com
  - itunes.apple.com
  - fonts.gstatic.com
  - smartclip.net
  - prod.http1.netflix.com
  - collector.github.com
  - backblazeb2.com
  - flutter.dev
  - firebaseinstallations.googleapis.com
  - firebaselogging-pa.googleapis.com
  - analytics.console.aws.a2z.com
  - sentry.io
  - sentry-cdn.com
  - newrelic.com
  - segment.io
  - revenuecat.com
  - onesignal.com
  - privacy-mgmt.com

app-template:
  global:
    fullnameOverride: adguard-home

  controllers:
    main:
      containers:
        main:
          image:
            repository: adguard/adguardhome
            pullPolicy: IfNotPresent
            tag: v0.107.39

          args:
            - --config
            - /opt/adguardhome/conf/AdGuardHome.yaml
            - --work-dir
            - /opt/adguardhome/work
            - --no-check-update

          resources:
            requests:
              cpu: 150m
              memory: 384Mi
            limits:
              cpu: 500m
              memory: 512Mi

      initContainers:
        copy-configmap:
          image:
            repository: busybox
            tag: 1.36
            pullPolicy: IfNotPresent
          command:
            - sh
            - -c
            - "mkdir -p /opt/adguardhome/conf; cp /tmp/AdGuardHome.yaml /opt/adguardhome/conf/AdGuardHome.yaml"
          securityContext:
            runAsUser: 0
          resources:
            requests:
              cpu: 10m
              memory: 16Mi
            limits:
              cpu: 100m
              memory: 32Mi

  serviceAccount:
    create: true

  defaultPodOptions:
    automountServiceAccountToken: false

  service:
    main:
      ports:
        http:
          port: 3000
    dns:
      enabled: true
      controller: main
      ipFamilyPolicy: PreferDualStack
      type: LoadBalancer
      externalTrafficPolicy: Local
      ports:
        dns-tcp:
          enabled: true
          port: 53
          protocol: TCP
          targetPort: 53
        dns-udp:
          enabled: true
          port: 53
          protocol: UDP
          targetPort: 53

  ingress:
    main:
      enabled: true

  persistence:
    config:
      enabled: true
      type: emptyDir
      globalMounts:
        - path: /opt/adguardhome/conf
    data:
      enabled: true
      type: persistentVolumeClaim
      storageClass: longhorn
      accessMode: ReadWriteOnce
      size: 5Gi
      retain: false
      globalMounts:
        - path: /opt/adguardhome/work
    adguard-home-config:
      enabled: true
      type: configMap
      name: adguard-home-config
      advancedMounts:
        main:
          copy-configmap:
            - path: /tmp/AdGuardHome.yaml
              subPath: AdGuardHome.yaml
